{"title":"Statistisk inferens, statistiske modeller og statistisk styrke","markdown":{"headingText":"Statistisk inferens, statistiske modeller og statistisk styrke","containsRefs":false,"markdown":"\nDenne rapporten er basert på simuleringer utført i R, der resultatene blir analysert gjennom svar på de spesifiserte spørsmåla (1–8). Gjennom grundig analyse og tolking av resultata gir rapporten ei forklaring som belyser de viktigste funna fra simuleringene.\n\n## Simulering til oppgåve 1-4\n\nFor å kunne svare på spørsmålene 1 til 4 så er det blitt gjort mange simuleringer med to ulike utvalgsstørrelser (n =8 og n = 40), som danner grunnlaget for to lineære modeller, `m1` og `m2`. De viktigste parametrene for modellene er vist i @tbl-modeller.\n\n```{r}\n#| label: tbl-modeller\n#| tbl-cap: \"Oversikt over de parametrene som vil bli diskutert videre i oppgaven.\"\n\n\n# Laster inn nødvendige pakker\nlibrary(tidyverse)\nlibrary(gridExtra)\nlibrary(gt)\n\n\nset.seed(1) # Sikrer at alle de tilfeldige tallene som generes er de \n# sammen hver gang koden kjøres\npopulation <- rnorm(1000000, mean = 1.5, sd = 3) # Generer 1 million \n# tilfeldige verdier som er normalfordelt\n\n# Sample 1\nsamp1 <- data.frame(y = sample(population, 8, replace = FALSE))\n\n# Sample 2\nsamp2 <- data.frame(y = sample(population, 40, replace = FALSE))\n\n# Lager lineære modeller for hver sample med kun en konstant\nm1 <- lm(y ~ 1, data = samp1)\nm2 <- lm(y ~ 1, data = samp2)\n\n# Henter ut nødvendige parametere fra modellene\nm1_summary <- summary(m1)$coefficients\nm2_summary <- summary(m2)$coefficients\n\n# Oppretter data for tabellen\nparameter_table <- data.frame(\n  Parameter = c(\"Estimat\", \"Standardfeil\", \"t-verdi\", \"p-verdi\"),\n  m1 = c(m1_summary[1, 1], m1_summary[1, 2], m1_summary[1, 3], \n         m1_summary[1, 4]),\n  m2 = c(m2_summary[1, 1], m2_summary[1, 2], m2_summary[1, 3], \n         m2_summary[1, 4])\n)\n\n# Lager tabellen med gt\nparameter_table %>%\n  gt() %>%\n  tab_header(\n    title = \"Parametere for modellene m1 og m2\"\n  )\n```\n\nUnder i @fig-samp1 vises t-fordelingen av de ulike lineære modellene, der det skyggelagte området visualiserer sannsynligheten for å observere en t-verdi som er like ekstrem eller mer ekstrem enn den observerte t-verdien i `samp1`, gitt at nullhypotesen om ingen endring er sann.\n\n```{r}\n#| label: fig-samp1\n#| fig-cap: \"t-fordeling av `samp1`.\"\n\n## Definer t-verdier for begge utvalg\nt_value1 <- 1.47  # t-verdi for samp1\nt_value2 <- 3.276  # t-verdi for samp2\ndf1 <- 7   # Antall frihetsgrader for samp1 (n-1, her 8-1=7)\ndf2 <- 39  # Antall frihetsgrader for samp2 (n-1, her 40-1=39)\n\n# Lag dataramme for x-verdier\nx_vals <- seq(-5, 5, length.out = 1000)\n\n# Lag plot for samp1\nplot1 <- ggplot(data.frame(x = x_vals), aes(x)) +\n  # Fyll venstre hale for samp1\n  stat_function(fun = dt, args = list(df = df1), xlim = c(-5, -t_value1), \n                geom = \"area\", fill = \"gray\", alpha = 0.5) +\n  # Fyll høyre hale for samp1\n  stat_function(fun = dt, args = list(df = df1), xlim = c(t_value1, 5), \n                geom = \"area\", fill = \"gray\", alpha = 0.5) +\n  # Tegn hele t-fordelingskurven for samp1\n  stat_function(fun = dt, args = list(df = df1)) +\n  # Legg til den observerte t-verdien som en vertikal linje\n  geom_vline(xintercept = t_value1, color = \"red\", linetype = \"dashed\") +\n  # Annoter t-verdien for samp1\n  annotate(\"text\", x = t_value1 + 0.3, y = 0.2, label = \"Observed t (samp1)\", \n           angle = -90, size = 2.8) +\n  labs(title = \"t-distribution for samp1\", x = \"t\", y = \"Density f(t)\") +\n  theme_classic() +\n  xlim(-5, 5)\n\n# Print plot1\nprint(plot1)\n\n# Utregne p-verdier for m1 og m2\np1 <- 2 * pt(t_value1, df = df1, lower.tail = FALSE)\np2 <- 2 * pt(t_value2, df = df2, lower.tail = FALSE)\n```\n\n### Spørsmål 1 - Forklaring av regresjonsresulateter: Estimat, SE, t-verdi og p-verdi\n\n**1. Explain the estimate, SE, t-value, and p-value from the regression models that we created previously (m1 and m2).**\n\n<u>**Estimate**</u>: Den estimerte koeffisienten representerer i regresjonsanalyser med to variabler hvor mykje vi kan forvente at den avhengige variabelen endrer seg per endring i den uavhengie variabelen (@RN2902, s.275). I våre \"intercept-only\" modeller, vil *estimate* derimot korrespondere til gjennomsnittet av alle verdiene i de ulike utvalgene, og gi oss et estimat på gjennomsnittet til populasjonen.\n\nI `samp1` er utvalgets gjennomsnitt `r round(mean(samp1$y), 3)` noe som er litt ifra populasjonens faktiske gjennomsnitt på 1.5. Når vi øker størrelsen på utvalget, slik som i `samp2`, ser vi at gjennomsnittet nærmer seg populasjonen: samp2 = `r round(mean(samp2$y), 3)` vs $\\mu$ = 1.5.\n\n<u>**Standardfeil (SE)**</u>: Standardfeilen måler hvor mykje *estimate* forventes å variere fra utvalg til utvalg [@RN2902, s.231, 403-404]. Standardfeilen sier dermed hvor mye gjennomsnittet vil kunne variere fra utvalg til utvalg grunnet tilfeldig variasjon i dataene. For eksempel sier standardfeilen i `m2` at gjennomsnittet vil variere med `r sd(samp2$y)/sqrt(40)` for hvert utvalg. SE beregnes slik:\n\n$$\n\\text{SE} = \\frac{s}{\\sqrt{n}}\n$$\n\nhvor:\n\n-   (s ) er standardavviket til utvalget\n-   ( n ) er antall observasjoner\n\n<u>**t-verdi**</u>: *t*-verdien, eller *t*-statistikk, beregnes som $t = \\frac{\\text{estimate}}{\\text{standard error}}$, og kan forstås som hvor mange standardfeil estimatet er fra 0 [@RN2902, s.276-277]. Den vil hjelpe oss med å avgjøre om det er fornuftig å anta at vårt gjennomsnitt er forskjellig fra 0, og om null-hypotesen burde forkastes eller godtas [@RN2902, s.276-277]. Dess høgere t-verdien er, dess sikrere kan vi være på at estimatet vårt, her *y*, oppsto ved tilfeldig variasjon gitt at nullhypotesen var sann.\n\n<u>**p-verdi**</u>: Gitt at vi veit *t*-verdien og størrelsen på utvalget, kan vi benytte oss av R til å regne ut *p*-verdien, (se `summary()` eller `p1`/`p2` i koden over): henholdsvis `r round(summary(m1)$coefficients[1,4], 3)` for `samp1` og `r round(summary(m2)$coefficients[1,4], 3)` for `samp2`.\n\nP-verdi defineres som sannsynligheten for å få et resultat så ekstremt som det observert, viss null hypotesen er virkelig sann [@RN2902, s. 264]. Hva terskel man setter for p-verdien vil variere basert på type studie og ønsket effekt, men historisk sett så er den p\\<0.05 sett på som statistisk signifikant. I vårt tilfelle er det kun `m2` som gir oss en p-verdi under 0.05, og er da statistisk signifikant. Samtidig er det viktig å understreke at p-verdien ikke sier noe om sannheten til en hypotese eller at statistisk signifikans betyr at det har praktisk eller klinisk betydning [@RN2902, s.297-303].\n\n### Spørsmål 2 - Årsaker til forskjeller mellom studieresulatene i modellene `m1` og `m2`.\n\n**2. Discuss what contributes to the different results in the two studies (m1 and m2).**\n\nDet første som burde påpekes er ulik utvalgsstørrelse på de to modellene. Ved større utvalg blir estimatene gjerne mer presise fordi tilfeldige variasjoner glattes ut. For eksempel så vil standardfeilen bli påvirket av størrelsen på utvalget, ved at et større utvalg vil føre til en lavere standardfeil (ref formelen over), som igjen kan gi en mer signifikant t-verdi og lavere p-verdi. Dette er tilfelle i modellene våre over, der `m2` har et større utvalg som fører til en lavere standardfeil, mer signifikant t-verdi og lavere p-verdi sammenlignet med `m1` [@RN2902, s.191-192].\n\nDen lave utvalgsstørrelsen i `m1` vil også føre til at tilfeldige variasjoner i datane vil kunne føre til at resultatene avviker mer fra den sanne populasjons gjennomsnittet enn `m2`. Forskjellen i standardfeilen mellom de to modellene, sier at det er forskjellig spredning i observasjonene. Den økte spredningen i `m1` vil bidra til mindre presise estimater, høyere p-verdi og mindre signifikante resultater [@RN2902, s.195].\n\n### Spørsmål 3 - Betydningen av skyggeområdene i halområdene til t-fordelingen i @fig-samp1.\n\n**3. Why do we use the shaded area in the lower and upper tail of the t-distribution (See @fig-samp1).**\n\nDe skyggelagte områdene hjelper å visualisere hvor sannsynlig eller usannsynlig den observerte t-verdien, gitt at nullhypotesen er sann (dvs. at $\\mu$ = 1.5). Ved å skyggelegge begge halene visualiseres man sannsynligheten for å få en t-verdi enten på den positive eller negative siden. Dess mindre det skyggelagte området er, desto mindre er det at vi vil observere en så ekstrem t-verdi, og desto mer sannsynlig er det at vi kan forkaste nullhypotesen.\n\n## Simulering til spørsmål 4-8\n\nMed hjelp av R har det blitt laget et datasett med resultat fra 1000 utførte studier, for å kunne utvikle en faktisk utvalgsdistribusjon. Ved å bruke `results` datasettet, skal eg svare på spørsmålene 4-7.\n\n```{r}\n# Lager data frames for å lagre modell estimater\nresults_8 <- data.frame(estimate = rep(NA, 1000), \n                        se = rep(NA, 1000), \n                        pval = rep(NA, 1000), \n                        n = 8)  \n\nresults_40 <- data.frame(estimate = rep(NA, 1000), \n                         se = rep(NA, 1000), \n                         pval = rep(NA, 1000), \n                         n = 40)\n\n# En løkke som for å hente ut 1000 prøver(samples), hver iterasjon (i) vil \n# hente ut en ny prøve fra populasjonen\n\nfor(i in 1:1000) {\n  \n  # Henter ut en prøve \n  samp1 <- data.frame(y = sample(population, 8, replace = FALSE))\n  samp2 <- data.frame(y = sample(population, 40, replace = FALSE))\n  \n  # Lager en lineær modell\n  m1 <- lm(y ~ 1, data = samp1)\n  m2 <- lm(y ~ 1, data = samp2)\n  \n  # Henter ut verdier fra modellen\n  results_8[i, 1] <- coef(summary(m1))[1, 1]\n  results_8[i, 2] <- coef(summary(m1))[1, 2]\n  results_8[i, 3] <- coef(summary(m1))[1, 4]\n  \n  results_40[i, 1] <- coef(summary(m2))[1, 1]\n  results_40[i, 2] <- coef(summary(m2))[1, 2]\n  results_40[i, 3] <- coef(summary(m2))[1, 4]\n  \n  \n}\n\n# Lagrer resultatene i en data frame\n\nresults <- bind_rows(results_8, results_40)\n```\n\n\n### Spørsmål 4 - Sammenligning av standardavvik og SE for utvalgsstørrelser (n = 8 og n = 40): Forklaring og definisjon. \n\n**4. Calculate the standard deviation of the estimate variable, and the average of the se variable for each of the study sample sizes (8 and 40). Explain why these numbers are very similar. How can you define the Standard Error (SE) in light of these calculations?**\n\nI @tbl-summary er det en oppsummering av standardavviket til `estimate` og gjennomsnittet av `se`:\n\n```{r}\n#| label: tbl-summary\n#| tbl-cap: \"Oppsummerende statistikk for standardavviket til `estimate` og gjennomsnittet av `se`.\"\n\nlibrary(knitr)\n\n# Filtrer ut resultatene for n = 8 og n = 40\n\nresults_n8 <- results %>% filter(n == 8) \nresults_n40 <- results %>% filter(n == 40)\n\n# Beregn standardavvik for estimate og gjennomsnitt for SE\n\nsummary_table <- data.frame( \n  \"Utvalgsstørrelse\" = c(8, 40), \n  \"Standardavvik\" = c(sd(results_n8$estimate), sd(results_n40$estimate)), \n  \"SE\" = c(mean(results_n8$se), mean(results_n40$se)))\n\n# Print tabellen med kable\n\nkable(summary_table)\n```\n\nStandardavviket av estimatene vil fortelle hvor mye estimatene vil variere fra prøve til prøve når vi trekker et tilfeldig utvalg av populasjonen - med andre ord vil det være den naturlige variasjonen i gjennomsnittet i utvalgene. Standardfeilen, har vi tidligere forklart, måler hvor mye vi forventer et estimat fra et enkelt utvalg vil avvike fra det sanne gjennomsnittet av populasjonen. Begge disse målene er relatert til den variasjonen vil vi kunne se i dataene, og sier oss noe om usikkerheten rundt gjennomsnittet i utvalget.\n\nStandardfeilen kan på mange måter ses på som et mål for presisjonen på estimatet (@RN2902, s.231). I vårt tilfelle vil det si hvor presist utvalgets gjennomsnitt estimerer populasjonens gjennomsnitt. Dess flere prøver man tar, vil standardfeilen nærme seg standardavviket av estimatene, fordi begge måler hvor mye estimatene varierer rundt det sanne gjennomsnittet.\n\n### Spørsmål 5 - Histogram av p-verdier og effekten av utvalgsstørrelse på statistisk styrke\n\n**5. Create a histogram of the p-values from each study sample-size. How do you interpret these histograms, what do they tell you about the effect of sample size on statistical power?**\n\n@fig-histo under viser fordelingen av p-verdier for n = 8 og n = 40, basert på de 1000 prøvene som har blitt generert.\n\n```{r}\n#| label: fig-histo\n#| fig-cap: \"Histogram av p-verdier.\"\n\nresults %>%\n  ggplot(aes(pval)) + \n  geom_histogram(binwidth = 0.05, fill = \"lightblue\", color = \"white\") +  # Juster binwidth hvis nødvendig\n  facet_wrap(~ n) +  # Lager ett histogram for n = 8 og ett for n = 40\n  labs(title = \"Histogram av p-verdier av utvalgsstørrelse n = 8 og n = 40\",\n       x = \"P-verdier\",\n       y = \"Frekvens\") +\n  theme_minimal()\n```\n\nBasert på tidligere diskusjon rundt usikkerheten og variasjon rundt estimatene, vil vi forvente å se en fordeling med flere p-verdier som er høyere enn 0.05 og dermed ikkje statistisk signifikant for *n = 8*. Noe som kommer tydelig frem i @fig-histo. For *n = 40* vil vi motsetning forvente at flere p-verdier som er lavere en 0.05, noe som vi også er tydelig i @fig-histo.\n\n**Statistisk power**, er beskrevet som sannsynligheten for å oppdage en sann effekt om den er tilstede (@RN2902, s.285). I praksis kan vi tenke på at høgere statistisk power øker sjansen til å finne signifikante resulateter når det finnes en reel effekt.\n\nEn faktor som vi så fint får visualisert i @fig-histo, er at statistisk power avhenger av blant annet utvalgsstørrelsen. Basert på det vi observerer i histogrammet, vil vi med større sikkerhet si at vi står bedre egnet til å oppdage en sann effekt (her det sanne gjennomsnittet) ved n = 40.\n\n### Spørsmål 6 - Antall studier med signifikante effekter for hver utvalgsstørrelse\n\n**6. Calculate the number of studies from each sample size that declare a statistical significant effect (specify a threshold $\\alpha$ for your significance level)**\n\nFor at studiene fra hvert utvalg skal bli med i summeringen, må de ha eit signifikansnivå på $\\alpha < 0.05$. Under i @tbl-sig ser man oversikten av hvor mange studier fra hvert utvalgsmål som er statistiske signifikante:\n\n```{r}\n#| label: tbl-sig\n#| tbl-cap: \"Proposisjoner av signifikante resultater utifra utvalgsstørrelse\"\n#| \nlibrary(kableExtra)\nlibrary(dplyr)\n\n# Beregn andelen signifikante resultater\nsig_table <- results %>%\n  filter(pval < 0.05) %>%\n  group_by(n) %>%\n  summarise(`α` = n()/1000)\n\n# Lag en tabell med kableExtra\nkable(sig_table, digits = 3) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n```\n\n### Spørsmål 7 - Beregning av statistisk styrke for en t-test med ulike utvalgsstørrelser ved bruk av `pwr`-pakken. \n\n**7. Using the pwr package, calculate the power of a one-sample t-test, with a effect size of 1.5/3, your specified significance level and sample sizes 8 and 40. Explain the results in the light of your simulations.**\n\nI @tbl-pwr er det vist den statistiske poweren for de ulike utvalgsstørrelsene. Som det ble nevnt tidligere, vil en høyere power styrke sannsynlighetene for å finne en signifikant forskjell viss den eksisterer, f.eks: en statistisk power på 0.8 tilsvarer at det er 80% sannsynlighet for at vi vil oppdage en statistisk forskjell viss den eksisterer.\n\n```{r}\n#| label: tbl-pwr\n#| tbl-cap: \"Statistisk power ved de ulike utvalgsstørrelsene\"\n\n# Laster inn pwr og knitr pakken\nlibrary(pwr)\nlibrary(knitr)\n\n# Beregn statistisk styrke for n = 8 og n = 40\npower_n8 <- pwr.t.test(n = 8, sig.level = 0.05, d = 1.5/3, type = \"one.sample\")\npower_n40 <- pwr.t.test(n = 40, sig.level = 0.05, d = 1.5/3, type = \"one.sample\")\n\n# Lag en tabell med resultatene\npower_results <- data.frame(\n  \"Sample Size\" = c(8, 40),\n  \"Power\" = c(power_n8$power, power_n40$power)\n)\n\n# Print tabellen pent med kable\nkable(power_results)\n\n```\n\nDen lave styrken for n = 8 sammenlignet med n = 40 som vi ser i @tbl-pwr, henger sammen med at det var færre ikke-signifikante tester for n = 8 versus n = 40 i @tbl-sig. Gjennomgående for når vi har sammenlignet de statistiske parametrene mellom de ulike utvalgene, er at eit større utvalg har gitt meir presisjon. Dette samsvarer godt med den statistiske poweren også: større utvalg vil øke sannsynligheten for signifikante resultater og økt statistisk power.\n\n### Spørsmål 8 - Antall falske positive resultater ved 5 % signifikansnivå ved gjentatte studier.\n\n**8. With a significance level of 5%, how many studies would give you a “false positive” result if you did many repeated studies?**\n\nI koden under har eg laget et nytt datasett med resultater fra flere tilfeldige utvalg med n = 8 og n = 40, fra en populasjon med en gjennomsnittlig effekt på 0.\n\n```{r}\npopulation <- rnorm(1000000, mean = 0, sd = 3)\n\n\n# Create data frames to store the model estimates\nresults_8 <- data.frame(estimate = rep(NA, 1000), \n                      se = rep(NA, 1000), \n                      pval = rep(NA, 1000), \n                      n = 8)  \n\nresults_40 <- data.frame(estimate = rep(NA, 1000), \n                      se = rep(NA, 1000), \n                      pval = rep(NA, 1000), \n                      n = 40)\n\n# A for loop used to sample 1000 studies, each iteration (i) will draw a new sample\n# from the population. \n\nfor(i in 1:1000) {\n  \n  # Draw a sample \n  samp1 <- data.frame(y = sample(population, 8, replace = FALSE))\n  samp2 <- data.frame(y = sample(population, 40, replace = FALSE))\n\n  # Model the data\n  m1 <- lm(y ~ 1, data = samp1)\n  m2 <- lm(y ~ 1, data = samp2)\n  \n  # Extract values from the models\n  results_8[i, 1] <- coef(summary(m1))[1, 1]\n  results_8[i, 2] <- coef(summary(m1))[1, 2]\n  results_8[i, 3] <- coef(summary(m1))[1, 4]\n\n  results_40[i, 1] <- coef(summary(m2))[1, 1]\n  results_40[i, 2] <- coef(summary(m2))[1, 2]\n  results_40[i, 3] <- coef(summary(m2))[1, 4]\n  \n  \n}\n\n\n# Save the results in a combined data frame\n\nresults_null <- bind_rows(results_8, results_40)\n```\n\nVidere har eg laget et histogram, @fig-histo0, for å visualisere andelen av p-verdier for de forskjellige utvalgsstørrelsene.\n\n```{r}\n#| label: fig-histo0\n#| fig-cap: \"Histogram av p-verdier med gjennomsnittlig effekt på 0\"\n\nlibrary(ggplot2)\n\n# Lag histogrammer av p-verdiene med fasetter for hver utvalgsstørrelse\nresults_null %>%\n  ggplot(aes(pval)) + \n  geom_histogram(binwidth = 0.05, fill = \"blue\", color = \"white\") + \n  facet_wrap(~ n, scales = \"free_y\") +\n  labs(title = \"Histogram av p-verdier med gjennomsnittlig effekt på 0\",\n       x = \"P-verdier\",\n       y = \"Frekvenser\") +\n  theme_minimal()\n```\n\nEt \"falskt positivt\" resultat oppstår når p-verdien er mindre enn signifikansnivået (her $\\alpha < 0.05$), selv om den sanne effekten i populasjonen er null (@RN2902, s.278). I @tbl-falsk ser vi at selv om effekten på populasjonen er lik null, er det omtrent 5% av studiene for begge utvalgsstørrelsene som feilaktig viser en statistisk signifikant effekt. Dette demonstrer i praksis konseptet med et signifikansnivå ($\\alpha < 0.05$), som betyr at vi tillater en 5% sjanse for å forkaste nullhypotesen når den er sann, bedre kjent som type I feil (@RN2902, s.283).\n\n```{r}\n#| label: tbl-falsk\n#| tbl-cap: \"Resultater av falske positive og ikke-signifikante tester per utvalgsstørrelse\"\n\nlibrary(knitr)\n\n# Beregn totalt antall tester og falske positive\ntotal_tests <- 1000  # Antall tester\nfalse_positives <- results_null %>%\n  filter(pval < 0.05) %>%\n  group_by(n) %>%\n  summarise(\"Antall falske positive\" = n(), \n            \"Falske positive (%)\" = (n() / total_tests) * 100)\n\n# Legg til totalt antall tester for å beregne ikke-signifikante resultater\nfalse_positives <- false_positives %>%\n  mutate(\"Antall ikke-signifikante\" = total_tests - `Antall falske positive`)\n\n# Lag en tabell med kable og norske kolonnenavn\nkable(false_positives, caption = \"Resultater av falske positive og ikke-signifikante tester per utvalgsstørrelse\", digits = 2)\n\n```\n\n## Vedlegg: Koder brukt\n\n```{r, echo=TRUE, results='hide'}\n\n# Laster inn nødvendige pakker\nlibrary(tidyverse)\nlibrary(gridExtra)\nlibrary(gt)\nlibrary(knitr)\nlibrary(pwr)\n\n\n\nset.seed(1) # Sikrer at alle de tilfeldige tallene som generes er de \n# sammen hver gang koden kjøres\npopulation <- rnorm(1000000, mean = 1.5, sd = 3) # Generer 1 million \n# tilfeldige verdier som er normalfordelt\n\n# Sample 1\nsamp1 <- data.frame(y = sample(population, 8, replace = FALSE))\n\n# Sample 2\nsamp2 <- data.frame(y = sample(population, 40, replace = FALSE))\n\n# Lager lineære modeller for hver sample med kun en konstant\nm1 <- lm(y ~ 1, data = samp1)\nm2 <- lm(y ~ 1, data = samp2)\n\n# Henter ut nødvendige parametere fra modellene\nm1_summary <- summary(m1)$coefficients\nm2_summary <- summary(m2)$coefficients\n\n# Oppretter data for tabellen\nparameter_table <- data.frame(\n  Parameter = c(\"Estimat\", \"Standardfeil\", \"t-verdi\", \"p-verdi\"),\n  m1 = c(m1_summary[1, 1], m1_summary[1, 2], m1_summary[1, 3], \n         m1_summary[1, 4]),\n  m2 = c(m2_summary[1, 1], m2_summary[1, 2], m2_summary[1, 3], \n         m2_summary[1, 4])\n)\n\n## Definer t-verdier for begge utvalg\nt_value1 <- 1.47  # t-verdi for samp1\nt_value2 <- 3.276  # t-verdi for samp2\ndf1 <- 7   # Antall frihetsgrader for samp1 (n-1, her 8-1=7)\ndf2 <- 39  # Antall frihetsgrader for samp2 (n-1, her 40-1=39)\n\n# Lag dataramme for x-verdier\nx_vals <- seq(-5, 5, length.out = 1000)\n\n# Utregne p-verdier for m1 og m2\np1 <- 2 * pt(t_value1, df = df1, lower.tail = FALSE)\np2 <- 2 * pt(t_value2, df = df2, lower.tail = FALSE)\n\n# Lager data frames for å lagre modell estimater\nresults_8 <- data.frame(estimate = rep(NA, 1000), \n                        se = rep(NA, 1000), \n                        pval = rep(NA, 1000), \n                        n = 8)  \n\nresults_40 <- data.frame(estimate = rep(NA, 1000), \n                         se = rep(NA, 1000), \n                         pval = rep(NA, 1000), \n                         n = 40)\n\n\n# En løkke som for å hente ut 1000 prøver(samples), hver iterasjon (i) vil \n# hente ut en ny prøve fra populasjonen\n\nfor(i in 1:1000) {\n  \n  # Henter ut en prøve \n  samp1 <- data.frame(y = sample(population, 8, replace = FALSE))\n  samp2 <- data.frame(y = sample(population, 40, replace = FALSE))\n  \n  # Lager en lineær modell\n  m1 <- lm(y ~ 1, data = samp1)\n  m2 <- lm(y ~ 1, data = samp2)\n  \n  # Henter ut verdier fra modellen\n  results_8[i, 1] <- coef(summary(m1))[1, 1]\n  results_8[i, 2] <- coef(summary(m1))[1, 2]\n  results_8[i, 3] <- coef(summary(m1))[1, 4]\n  \n  results_40[i, 1] <- coef(summary(m2))[1, 1]\n  results_40[i, 2] <- coef(summary(m2))[1, 2]\n  results_40[i, 3] <- coef(summary(m2))[1, 4]\n  \n  \n}\n\n# Lagrer resultatene i en data frame\nresults <- bind_rows(results_8, results_40)\n\n\n# Filtrer ut resultatene for n = 8 og n = 40\nresults_n8 <- results %>% filter(n == 8) \nresults_n40 <- results %>% filter(n == 40)\n\n# Beregn standardavvik for estimate og gjennomsnitt for SE\nsummary_table <- data.frame( \n  \"Utvalgsstørrelse\" = c(8, 40), \n  \"Standardavvik\" = c(sd(results_n8$estimate), sd(results_n40$estimate)), \n  \"SE\" = c(mean(results_n8$se), mean(results_n40$se)))\n\n\n# Beregn andelen signifikante resultater\nsig_table <- results %>%\n  filter(pval < 0.05) %>%\n  group_by(n) %>%\n  summarise(`α` = n()/1000)\n\n# Beregn statistisk styrke for n = 8 og n = 40\npower_n8 <- pwr.t.test(n = 8, sig.level = 0.05, d = 1.5/3, type = \"one.sample\")\npower_n40 <- pwr.t.test(n = 40, sig.level = 0.05, d = 1.5/3, type = \"one.sample\")\n\n# Lag en dataframe med resultatene\npower_results <- data.frame(\n  \"Sample Size\" = c(8, 40),\n  \"Power\" = c(power_n8$power, power_n40$power)\n)\n\npopulation <- rnorm(1000000, mean = 0, sd = 3)\n\n\n# Lag data frames for å lagre modellene sine estimater\nresults_8 <- data.frame(estimate = rep(NA, 1000), \n                      se = rep(NA, 1000), \n                      pval = rep(NA, 1000), \n                      n = 8)  \n\nresults_40 <- data.frame(estimate = rep(NA, 1000), \n                      se = rep(NA, 1000), \n                      pval = rep(NA, 1000), \n                      n = 40)\n\n\n# Lagre resultatene i en data frame\n\nresults_null <- bind_rows(results_8, results_40)\n\n# Beregn totalt antall tester og falske positive\ntotal_tests <- 1000  # Antall tester\nfalse_positives <- results_null %>%\n  filter(pval < 0.05) %>%\n  group_by(n) %>%\n  summarise(\"Antall falske positive\" = n(), \n            \"Falske positive (%)\" = (n() / total_tests) * 100)\n\n# Legg til totalt antall tester for å beregne ikke-signifikante resultater\nfalse_positives <- false_positives %>%\n  mutate(\"Antall ikke-signifikante\" = total_tests - `Antall falske positive`)\n```\n","srcMarkdownNoYaml":""},"formats":{"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","number-sections":true,"toc":true,"output-file":"03-statistical-inference.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["resources/bib-final.bib"],"crossref":{"fig-title":"Figur","tbl-title":"Tabell"},"csl":"resources/apa.csl"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["pdf"]}